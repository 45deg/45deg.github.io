import{m as v,B as d}from"./colorToUniform-Cgr_0pYQ.js";import{T as p,D as x,n as l}from"./index-CNRvkdKq.js";const u={};function P(n,t){let e=0;for(let a=0;a<t;a++)e=e*31+n[a].uid>>>0;return u[e]||C(n,e)}let c=0;function C(n,t){const e={};let a=0;c||(c=v());for(let o=0;o<c;o++){const r=o<n.length?n[o]:p.EMPTY.source;e[a++]=r.source,e[a++]=r.style}const s=new d(e);return u[t]=s,s}class i{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const a=x.get().createCanvas();a.width=t,a.height=e;const s=a.getContext("2d");return{canvas:a,context:s}}getOptimalCanvasAndContext(t,e,a=1){t=Math.ceil(t*a-1e-6),e=Math.ceil(e*a-1e-6),t=l(t),e=l(e);const s=(t<<17)+(e<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let o=this._canvasPool[s].pop();return o||(o=this._createCanvasAndContext(t,e)),o}returnCanvasAndContext(t){const{width:e,height:a}=t.canvas,s=(e<<17)+(a<<1);this._canvasPool[s].push(t)}clear(){this._canvasPool={}}}const _=new i;export{_ as C,P as g};
